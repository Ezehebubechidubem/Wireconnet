<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="author" content="Mr Dubem">
  <meta name="description" content="HTML practice">
  <meta name="keywords" content="HTML,CSS,JS">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>GTAN</title>
  <style>
    /* ---------- Base reset ---------- */
    *{ margin:0; padding:0; box-sizing:border-box; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
    html,body{ height:100%; }

    /* ---------- Header / layout helpers ---------- */
    .bend {
      --hdr-h: 64px;                /* header visual height (used for spacing) */
      display:flex;
      justify-content:space-between;
      align-items:center;
      background-color:white;
      border:1px solid black;
      position:fixed;
      top:0; left:0; right:0;
      height: var(--hdr-h);
      padding:8px 12px;
      z-index:1000;
    }
    /* Override inline img width attribute so logo scales */
    .bend figure { margin:0; display:flex; align-items:center; }
    .bend figure img {
      width:auto !important;
      max-width:220px !important;
      height:auto !important;
      max-height:48px !important;
      object-fit:contain;
      display:block;
    }

    main { padding-top: calc(var(--hdr-h) + 12px); min-height:100vh; }

    /* ---------- Typography and spacing ---------- */
    .brief{
      color:black;
      display:flex;
      justify-content:flex-start;
      padding:18px;
      font-weight:700;
      font-style:italic;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
    }

    .sort{
      color:rgba(0,0,200,1);
      padding:5px;
      font-size:48px; /* lowered default from 85 */
      text-align:center;
      line-height:1;
      margin:0 12px;
      word-break:break-word;
    }
    .dent{
      display:flex;
      justify-content:center;
      padding:8px 0 20px;
    }
    .fit{
      padding:16px;
      line-height:1.6;
      font-size:18px;
    }

    fieldset{ border:1px solid black; border-radius:10px; height:70px; }

    .do{
      display:inline-grid;
      place-items:center;
      text-decoration:none;
      border:2px solid black;
      border-radius:20px;
      min-width:140px;
      background-color:blue;
      color:white;
      padding:8px 12px;
      margin:6px;
      font-weight:700;
    }
    .audit,.audits{ display:flex; justify-content:center; padding:16px; margin:10px; flex-wrap:wrap; gap:8px; }
    .to{
      display:inline-grid;
      place-items:center;
      text-decoration:none;
      border:2px solid black;
      border-radius:20px;
      min-width:140px;
      background-color:blue;
      color:white;
      padding:8px 12px;
      margin:6px;
      font-weight:bold;
    }
    .auditss{ display:flex; justify-content:center; padding:10px; margin:10px; width:300px; gap:8px; flex-wrap:wrap; }

    .images, .imagecap { display:flex; justify-content:center; font-weight:bold; text-transform:uppercase; padding:12px; }
    .image img, .images img { max-width:100%; height:auto; display:block; }

    .meet{ padding:12px; display:flex; justify-content:center; }

    .dif,.cut{ padding:10px; line-height:1.6; }

    .suf{ border:none; color:blue; font-weight:bold; text-decoration:none; padding:12px; display:inline-block; margin-top:12px; }

    .AI{ position: fixed; background-color:white; border:none; right:12px; bottom:12px; z-index:1000; max-width:120px; }
    .AI img{ max-width:100%; height:auto; display:block; }

    .bond{ padding:10px; }

    /* ---------- Hamburger menu (kept as requested) ---------- */
    .hamburger-container { position: fixed; top: calc(var(--hdr-h) + 6px); right: 12px; z-index:2000; }
    .hamburger { font-size: 24px; background: #fff; border:1px solid #000; border-radius:6px; padding:6px 10px; cursor:pointer; }
    .menu-dropdown {
      display:none;
      background:white;
      border:1px solid black;
      border-radius:10px;
      width:260px;
      padding:10px;
      margin-top:8px;
      box-shadow:0 6px 18px rgba(0,0,0,0.12);
    }
    .menu-dropdown a.menu-link { display:block; padding:8px; text-decoration:none; color:black; font-weight:700; border-radius:6px; margin-bottom:6px; }
    .menu-dropdown a.book-btn { background:blue; color:#fff; text-align:center; display:block; padding:10px; border-radius:8px; text-decoration:none; font-weight:800; }

    /* ---------- Toggle switch ---------- */
    .status-toggle { display:flex; justify-content:space-between; align-items:center; margin-top:12px; gap:8px; }
    .status-note { font-size:12px; color:#444; margin-top:6px; }
    .switch{ position:relative; display:inline-block; width:54px; height:30px; }
    .switch input{ opacity:0; width:0; height:0; }
    .slider{ position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0; background:#999; transition:.3s; border-radius:30px; }
    .slider:before{ position:absolute; content:""; height:22px; width:22px; left:4px; bottom:4px; background:#fff; transition:.3s; border-radius:50%; box-shadow:0 2px 5px rgba(0,0,0,.2); }
    input:checked + .slider{ background:#28a745; }
    input:checked + .slider:before{ transform:translateX(24px); }

    /* ---------- Online indicator ---------- */
    .online-indicator { display:inline-flex; align-items:center; gap:8px; margin-left:12px; font-weight:700; }
    .indicator-dot { width:14px; height:14px; border-radius:50%; background:gray; display:inline-block; }
    .indicator-online { background:#28a745; box-shadow:0 0 8px rgba(40,167,69,.25); }
    .indicator-offline { background:gray; box-shadow:none; }

    /* ---------- Toast ---------- */
    .toast{ position:fixed; top:12px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,.8); color:#fff; padding:8px 12px; border-radius:8px; display:none; z-index:4000; }

    /* ---------- Make large hero / image areas responsive ---------- */
    article.image { margin:12px; }
    .imagecap { margin-top:6px; margin-bottom:8px; font-weight:700; }

    /* ---------- Small screens responsive tweaks ---------- */
    @media (max-width:900px){
      .sort{ font-size:40px; }
      .fit{ font-size:17px; padding:12px; }
      .brief{ padding:12px; }
      .hamburger-container{ top: calc(var(--hdr-h) + 6px); right:10px; }
    }
    @media (max-width:600px){
      .sort{ font-size:28px; }
      .bend { --hdr-h:56px; height:56px; padding:6px 10px; }
      main { padding-top: calc(var(--hdr-h) + 10px); }
      .bend figure img{ max-width:180px; max-height:44px; }
      .fit{ font-size:15px; padding:10px; }
      .brief{ padding:10px; font-size:14px; }
      .audit,.audits{ padding:10px; gap:6px; }
      .auditss{ width:auto; padding:8px; gap:6px; }
      .menu-dropdown{ width:220px; right:6px; }
      .hamburger{ font-size:22px; padding:6px 8px; }
      .hamburger-container{ top: calc(var(--hdr-h) + 6px); right:8px; }
    }
    @media (min-width:1200px){
      .sort{ font-size:85px; } /* preserve large size on wide screens if desired */
    }

    /* ensure all images never overflow */
    img{ max-width:100%; height:auto; display:block; }

  </style>
  </head>
<body data-user-id="">
  <header>
    <div class="bend">
      <figure>
        <!-- kept the same img tag (CSS overrides its width) -->
        <img src="https://i.postimg.cc/ZRSK3pJx/IMG-20260202-144108.png" alt="Gtan logo" width="450px" height="120px">
      </figure>

      <div style="display:flex; align-items:center; gap:8px;">
        <a href="search.html" class="search" style="text-decoration:none; font-size:18px; padding-right:6px;">üîç</a>
      </div>
    </div>
  </header>

  <main>
    <p class="brief">
      Motto: Let Their Be Light üí•üí•
      <span class="online-indicator" id="onlineIndicatorContainer" aria-live="polite">
        <span class="indicator-dot indicator-offline" id="indicatorDot"></span>
        <span id="indicatorText">Offline</span>
      </span>
    </p>

    <div class="sort">
      <p class="dent">WireConnect Network</p>
    </div>

    <div class="fit">
      <p>WireConnect is a professional platform connecting skilled electrical technicians, verified service bookings, and trusted client projects. Built from Africa for the world, every connection supports real workmanship while enabling reliable service delivery.</p>

      <div class="audit">
        <p><a class="do" href="#">Book A Job</a></p>
        <p><a class="do" href="#">View All Jobs</a></p>
      </div>

      <div class="audits">
        <p><a class="do" href="#">Do Kyc</a></p>
        <p><a class="do" href="#">Customer Services</a></p>
      </div>
    </div>

    <div class="auditss">
      <p><a class="to" href="#">Client Leaderboard</a></p>
      <p><a class="to" href="#">Technician Leaderboard</a></p>
    </div>

    <article class="image">
      <figure class="images">
        <img src="https://i.postimg.cc/904qWnn7/icon-service-1.png" alt="decentralized">
      </figure>

      <p class="imagecap">Distributed Network</p>
      <p>Centralised platforms have a single point of failure: if the system breaks, the entire network is stalled until the issue is resolved.
Wire Connect avoids this risk by operating through a distributed service network, designed for reliability, transparency, and uninterrupted operations.</p>

      <figure class="images">
        <img src="https://i.postimg.cc/Y2Gs5tzZ/icon-service-2.png" alt="Your secure way ti crypto">
      </figure>
      <p class="imagecap">Your Secure Way to Services</p>
      <p>The WireConnect platform is designed for everyday use. Secure, simple, and reliable, it allows clients to find, book, and manage technicians with ease. It also integrates a unique feature ‚Äî the ability to access verified professionals directly through your service requests.</p>

      <figure class="images">
        <img src="https://i.postimg.cc/X7vms9Dk/icon-service-3.png" alt="Giant Launcpad">
      </figure>
      <p class="imagecap">Wire Connect Hub</p>
      <p class="bond">Empowering the Next Generation of Technicians.</p>
      <p>The WireConnect Hub connects skilled professionals with active clients. It offers a fair and transparent platform for technicians to get jobs, while giving clients early access to vetted experts. A service hub built with integrity, for Africa and beyond.</p>
    </article>

    <aside>
      <figure>
        <img src="https://i.postimg.cc/hPzWS9bF/service-image-1.png" alt="service image" class="meet">
      </figure>

      <h2>Meet the WireConnect Network</h2>
      <p class="cut"><strong>The WireConnect Network</strong> is more than a platform ‚Äî it‚Äôs a movement. Every part of our system is designed to empower skilled technicians, build trust, and drive community growth across Africa and beyond.</p>

      <p class="dif">
        <ul>
          <li class="dif"><strong>Service with Purpose:</strong> A portion of every connections supports widows, the elderly, and vulnerable communities, making real impact where it‚Äôs needed most.</li>
          <li class="dif"><strong>Wire Connect Hub: </strong>A transparent platform helping skilled technicians secure jobs, giving clients early access to vetted professionals.</li>
          <li class="dif"><strong>Powered by Community:</strong> At Wire Connect, people come first. Our community drives growth, trust, and lasting impact across the platform.</li>
        </ul>
      </p>

      <a class="suf" href="#">Learn More</a>
    </aside>

    <aside class="AI">
      <a href="#"><img src="https://i.postimg.cc/66GgyB9s/chat-traditional-1.jpg" alt="chat"></a>
    </aside>

  </main>

  <!-- Hamburger Menu (kept in same place) -->
  <div class="hamburger-container" aria-expanded="false">
    <button class="hamburger" id="hamburgerBtn" aria-controls="menuDropdown" aria-expanded="false">‚ò∞</button>

    <div class="menu-dropdown" id="menuDropdown" role="menu" aria-hidden="true">
      <a class="menu-link" href="profile.html">Profile</a>
      <a class="menu-link" href="settings.html">Settings</a>
      <a class="menu-link" href="kyc.html">KYC</a>

      <a class="book-btn" href="book.html">Book Job</a>

      <div class="status-toggle">
        <span>Status:</span>
        <label class="switch" title="Toggle online / offline">
          <input type="checkbox" id="statusSwitch" aria-label="Online toggle">
          <span class="slider"></span>
        </label>
      </div>
      <div class="status-note">Toggle to set technician availability (sends status to backend)</div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // ---- CONFIG: point to your backend ----
    const API_BASE = 'https://wireconnet-1.onrender.com';

    // UI elements
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    const menuDropdown = document.getElementById('menuDropdown');
    const statusSwitch = document.getElementById('statusSwitch');
    const indicatorDot = document.getElementById('indicatorDot');
    const indicatorText = document.getElementById('indicatorText');
    const toastEl = document.getElementById('toast');

    // Toggle the hamburger menu visibility
    (function(){
      const btn = hamburgerBtn;
      const menu = menuDropdown;
      btn.addEventListener('click', (e)=>{
        e.stopPropagation();
        const shown = menu.style.display === 'block';
        menu.style.display = shown ? 'none' : 'block';
        btn.setAttribute('aria-expanded', !shown);
        menu.setAttribute('aria-hidden', shown);
      });

      // close menu when clicking outside
      document.addEventListener('click', (e)=>{
        const container = document.querySelector('.hamburger-container');
        if(!container.contains(e.target)){
          menu.style.display = 'none';
          btn.setAttribute('aria-expanded', false);
          menu.setAttribute('aria-hidden', true);
        }
      });
    })();

    // helper: show toast
    function showToast(msg, ms = 3000){
      toastEl.innerText = msg;
      toastEl.style.display = 'block';
      setTimeout(()=> { toastEl.style.display = 'none'; }, ms);
    }

    // helper: set indicator on main page
    function setIndicator(online){
      if(online){
        indicatorDot.classList.remove('indicator-offline');
        indicatorDot.classList.add('indicator-online');
        indicatorText.innerText = 'Online';
      } else {
        indicatorDot.classList.remove('indicator-online');
        indicatorDot.classList.add('indicator-offline');
        indicatorText.innerText = 'Offline';
      }
    }

    // Obtain user id from body attribute or localStorage
    function getUserId(){
      const id = document.body.getAttribute('data-user-id') || localStorage.getItem('userId');
      return id && id.trim() !== '' ? id : null;
    }

    // Save last-known online state to localStorage (per user)
    function storeLastKnownOnline(userId, online){
      if(!userId) return;
      try { localStorage.setItem('techOnline_' + userId, online ? '1' : '0'); } catch(e){}
    }
    function readLastKnownOnline(userId){
      if(!userId) return null;
      try {
        const v = localStorage.getItem('techOnline_' + userId);
        if(v === null) return null;
        return v === '1';
      } catch(e){ return null; }
    }

    // Attempt to send status change to backend with timeout
    async function sendStatusToBackend(userId, online, lat = null, lng = null){
      const url = API_BASE + '/api/tech/status';
      // small timeout for fetch
      const controller = new AbortController();
      const timeout = setTimeout(()=> controller.abort(), 12000); // 12s
      try {
        const resp = await fetch(url, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          signal: controller.signal,
          body: JSON.stringify({ techId: userId, online: !!online, lat: lat, lng: lng })
        });
        clearTimeout(timeout);
        const json = await resp.json().catch(()=> null);
        if(!resp.ok){
          // return an object indicating failure and message if available
          return { success:false, message: (json && json.message) ? json.message : ('HTTP ' + resp.status) };
        }
        return json; // should contain { success:true, message: ... }
      } catch(err){
        clearTimeout(timeout);
        if(err.name === 'AbortError') return { success:false, message: 'Request timed out' };
        return { success:false, message: err.message || 'Network error' };
      }
    }

    // Main handler when user toggles switch
    async function handleSwitchToggle(e){
      const checked = e.target.checked;
      const userId = getUserId();
      if(!userId){
        // revert switch and inform developer/user to set id
        statusSwitch.checked = !checked;
        showToast('No user id found. Set body[data-user-id] or localStorage.userId to enable status updates.', 5000);
        return;
      }

      // get geolocation (best-effort, do not block UX too long)
      let lat = null, lng = null;
      if(navigator.geolocation){
        try{
          const pos = await new Promise((resolve, reject) => {
            const t = setTimeout(() => reject(new Error('geolocation timeout')), 4500);
            navigator.geolocation.getCurrentPosition((p) => { clearTimeout(t); resolve(p); }, (err) => { clearTimeout(t); reject(err); }, { maximumAge: 10000, timeout: 4500 });
          });
          lat = pos.coords.latitude;
          lng = pos.coords.longitude;
        }catch(err){
          // ignore geolocation errors
          console.warn('geolocation unavailable', err);
        }
      }

      // optimistic UI: set indicator and keep switch while request is in-flight
      setIndicator(checked);
      statusSwitch.disabled = true;
      showToast( checked ? 'Setting status to Online...' : 'Setting status to Offline...', 2000 );

      // send
      const result = await sendStatusToBackend(userId, checked, lat, lng);
      statusSwitch.disabled = false;

      if(result && result.success){
        // success: persist last-known state
        storeLastKnownOnline(userId, checked);
        showToast('Status updated');
      } else {
        // failure: revert UI to previous state and show message
        const prev = !checked;
        statusSwitch.checked = prev;
        setIndicator(prev);
        const msg = (result && result.message) ? result.message : 'Failed to update status';
        showToast('Error: ' + msg, 6000);
        // also alert for visibility
        alert('Could not update status: ' + msg);
      }
    }

    // Wire the switch event
    statusSwitch.addEventListener('change', handleSwitchToggle);

    // On load: set switch and indicator from localStorage for this user (best-effort)
    (function initFromLocal(){
      const userId = getUserId();
      if(!userId) {
        // nothing to pre-populate; leave offline default
        setIndicator(false);
        return;
      }
      const known = readLastKnownOnline(userId);
      if(known === null){
        // no saved state ‚Äî leave defaults (offline)
        setIndicator(false);
        statusSwitch.checked = false;
      } else {
        statusSwitch.checked = !!known;
        setIndicator(!!known);
      }
    })();

    // Accessibility: close dropdown with Escape
    document.addEventListener('keydown', (e)=> {
      if(e.key === 'Escape') {
        menuDropdown.style.display = 'none';
        hamburgerBtn.setAttribute('aria-expanded', false);
        menuDropdown.setAttribute('aria-hidden', true);
      }
    });

    // Expose small helper to programmatically set user id
    // You can call in browser console: localStorage.setItem('userId','THE_USER_ID') or set <body data-user-id="...">
    // Optional: if you want to auto-read user object from /api/login etc, implement login flow and set localStorage.userId on success.
  </script>
</body>
</html>