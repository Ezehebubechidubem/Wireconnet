<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WireConnect — Profile</title>
  <style>
    :root{--bg:#f6f8fb;--accent:#0b5cff;--muted:#6b7280}
    html,body{height:100%;margin:0}
    body{font-family:Inter, "Segoe UI", Roboto, Arial;background:var(--bg);color:#111827}
    .banner{width:100%;height:120px;display:flex;align-items:center;justify-content:center;overflow:hidden;box-shadow:0 8px 24px rgba(11,92,255,0.08)}
    .banner img{width:100%;height:70%;}
    .wrap{max-width:920px;margin:18px auto;padding:16px}
    .card{background:#fff;border-radius:12px;padding:16px;box-shadow:0 8px 30px rgba(16,24,40,0.06)}
    label{display:block;margin-bottom:6px;font-weight:600}
    input,select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ef;margin-bottom:10px}
    button{background:var(--accent);color:#fff;padding:10px;border-radius:8px;border:0;cursor:pointer}
    .small{color:var(--muted);font-size:13px}
  </style>
</head>
<body>
  <div class="banner" aria-hidden="true">
    <img src="https://i.postimg.cc/ZRSK3pJx/IMG-20260202-144108.png" alt="WireConnect banner">
  </div>

  <div class="wrap">
    <div class="card">
      <h3>Profile — Account details</h3>

      <form id="profileForm" onsubmit="return false" enctype="multipart/form-data">
        <label for="avatar">Profile picture (optional)</label>
        <input id="avatar" name="avatar" type="file" accept="image/*" capture="environment">

        <label for="displayName">Display name</label>
        <input id="displayName" name="displayName" type="text" placeholder="John Doe">

        <label for="bank">Account details (bank / Paystack ID)</label>
        <input id="bank" name="bank" type="text" placeholder="Account number or Paystack identifier">

        <label for="bio">Short bio (optional)</label>
        <textarea id="bio" name="bio" rows="3" placeholder="Tell clients about yourself"></textarea>

        <div style="display:flex;gap:8px">
          <button id="saveProfile">Save profile</button>
          <button id="backDashboard" style="background:#eef2ff;color:var(--accent);border:0;padding:10px;border-radius:8px;cursor:pointer">Back</button>
        </div>

        <div id="msg" class="small" style="margin-top:10px"></div>
      </form>
    </div>
  </div>

  <script>
    const BACKEND = 'https://wireconnet-1.onrender.com';
    function postFormData(url, fd){
      return fetch(url, { method:'POST', body: fd, credentials:'include' }).then(r=>r.json()).catch(()=>({ success:false, message:'Network error' }));
    }

    document.getElementById('saveProfile').addEventListener('click', async () => {
      const avatar = document.getElementById('avatar').files[0];
      const displayName = document.getElementById('displayName').value.trim();
      const bank = document.getElementById('bank').value.trim();
      const bio = document.getElementById('bio').value.trim();
      const msg = document.getElementById('msg');

      const fd = new FormData();
      if(avatar) fd.append('avatar', avatar);
      fd.append('displayName', displayName);
      fd.append('accountDetails', bank);
      fd.append('bio', bio);

      msg.textContent = 'Saving...';
      const res = await postFormData(BACKEND + '/api/profile', fd);
      if(res && res.success){
        msg.textContent = 'Profile saved.';
        if(res.user) localStorage.setItem('wc_user', JSON.stringify(res.user));
      } else {
        msg.textContent = res.message || 'Failed to save profile.';
      }
    });

    document.getElementById('backDashboard').addEventListener('click', (e)=>{
      e.preventDefault();
      window.location.href = 'dashboard.html';
    });
  </script>
</body>
</html>